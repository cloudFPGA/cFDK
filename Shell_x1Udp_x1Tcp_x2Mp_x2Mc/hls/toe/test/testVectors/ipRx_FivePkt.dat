# ###################################################################################################################################
#  @file  : ipRx_OnePkt.dat
#  @brief : A unique IPv4 packet following a SYN packet that opens the connection.
#
#  @info : Such a '.dat' file can also contain global testbench parameters,
#          testbench commands and comments.
#
#  @details:
#   A global parameter, a testbench command or a comment line must start with a
#    single character (G|>|#) followed by a space character.
#   Examples:
#    G PARAM SimCycles     <NUM>         --> Request a minimum of <NUM> simulation cycles.
#    G PARAM LocalSocket   <ADDR> <PORT> --> Request to setup a local socket for the TOE. 
#    G PARAM ForeignSocket <ADDR> <PORT> --> Request to setup a foreign socket for the host.
#    # This is a comment
#    > SET   ForeignSocket <ADDR> <PORT> --> Request to add foreign socket.
#    > IDLE  <NUM>                       --> Request to idle for <NUM> cycles.
# 
# ###################################################################################################################################
#          
#         6                   5                   4                   3                   2                   1                   0   
#   3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0      
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  | Frag. Offset  |Flags|         |         Identification        |          Total Length         |Type of Service|Version|  IHL  |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |                       Source Address                          |         Header Checksum       |    Protocol   |  Time to Live |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |       Destination Port        |          Source Port          |                    Destination Address                        |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |                    Acknowledgment Number                      |                        Sequence Number                        |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |                               |                               |                               |   |U|A|P|R|S|F|  Data |       |
#  |         Urgent Pointer        |           Checksum            |            Window             |   |R|C|S|S|Y|I| Offset|  Res  |
#  |                               |                               |                               |   |G|K|H|T|N|N|       |       |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |                                                             data                                                              |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#
# @details :
#   * The first segement is used to open the connection with the following settings:
#      IP-SA = 10.12.200.50, IP-DA=10.12.200.19, TCP-SP=41571(0xa263), TCP-DP=8803(0x2263)
#
#   The corresponding data stream received from the MAC is as follows:
#          
#         6                   5                   4                   3                   2                   1                   0   
#   3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0      
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |             0x0040            |            0x9409             |            0x3c00 (60)        |      0x00     |     0x45      |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |                         0x32c80c0a                            |            0xca8c             |      0x06     |     0x40      |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |             0x6322 (8803)     |            0x63a2 (41571)     |                         0x13c80c0a                            |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |                         0x00000000                            |                         0x16c3e5c8 (3,370,500,886)            |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |                               |                               |                               |   |U|A|P|R|S|F|               |
#  |             0x0000            |            0x8ca4 (42124)     |            0x1072 (29200)     |   |R|C|S|S|Y|I|     0xa0      |
#  |                               |                               |                               |   |G|K|H|T|N|N|               |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |                                                       0x0a080204b4050402                                                      |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |                                                       0x0000000082ca0359                                                      |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#  |                                                       0x0000000007030301                                                      |
#  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#
# ###################################################################################################################################

G PARAM SimCycles   500
G PARAM LocalSocket 0x0A0CC813 0x2263

> IDLE 100

# ==== STEP-1: TCP CONNECTION ESTABLISHMENT (TCP-SYN) ====================
# 0000   70 b3 d5 70 8f f7 3c fd fe 9f 59 78 08 00 45 00  p..p..<...Yx..E.
# 0010   00 3c 09 94 40 00 40 06 8c ca 0a 0c c8 32 0a 0c  .<..@.@......2..
# 0020   c8 13 a2 63 22 63 c8 e5 c3 16 00 00 00 00 a0 02  ...c"c..........
# 0030   72 10 a4 8c 00 00 02 04 05 b4 04 02 08 0a 59 03  r.............Y.
# 0040   ca 82 00 00 00 00 01 03 03 07                    ..........

# 45 00 00 3c 09 94 40 00
004094093c000045 0 FF
# 40 06 8c ca 0a 0c c8 32
32c80c0aca8c0640 0 FF
# 0a 0c c8 13 a2 63 22 63
632263a213c80c0a 0 FF
# c8 e5 c3 16 00 00 00 00
0000000016c3e5c8 0 FF
# a0 02 72 10 a4 8c 00 00
00008ca4107202a0 0 FF
# 02 04 05 b4 04 02 08 0a
0a080204b4050402 0 FF
# 59 03 ca 82 00 00 00 00
0000000082ca0359 0 FF
# 01 03 03 07
0000000007030301 1 0F 


> IDLE 100

# == STEP-2: TCP DATA TRANSFER =============================
# 0000000051000045 0 FF
# 0A0A0A0A000006FF 0 FF
# 5700890001C80C0A 0 FF
# 00000000CEFF0000 0 FF
# 00001d8700041050 0 FF
# 88DAC85D74C01B7F 0 FF
# CAD7EE7357BF4667 0 FF
# C84312CF15850E56 0 FF
# 7AB53EB68FCD338E 0 FF
# 858486046701C275 0 FF
# 0000000000000046 1 01

> IDLE 100
